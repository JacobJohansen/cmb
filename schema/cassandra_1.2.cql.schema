--DROP KEYSPACE "CMB";
--DROP KEYSPACE "CQS";
--DROP KEYSPACE "CNS";

-- modify to adjust replication strategy

--CREATE KEYSPACE IF NOT EXISTS "CMB" WITH replication = { 'class' : 'SimpleStrategy', 'replication_factor' : 3 };
--CREATE KEYSPACE IF NOT EXISTS "CQS" WITH replication = { 'class' : 'SimpleStrategy', 'replication_factor' : 3 };
--CREATE KEYSPACE IF NOT EXISTS "CNS" WITH replication = { 'class' : 'SimpleStrategy', 'replication_factor' : 3 };

CREATE KEYSPACE IF NOT EXISTS "CMB" WITH replication = { 'class' : 'SimpleStrategy', 'replication_factor' : 1 };
CREATE KEYSPACE IF NOT EXISTS "CQS" WITH replication = { 'class' : 'SimpleStrategy', 'replication_factor' : 1 };
CREATE KEYSPACE IF NOT EXISTS "CNS" WITH replication = { 'class' : 'SimpleStrategy', 'replication_factor' : 1 };

USE "CNS";

CREATE TABLE "CNSAPIServers" (
   "host" text,
   "timestamp" text,
   "jmxport" text,
   "dataCenter" text,
   "serviceUrl" text,
  PRIMARY KEY ((key), column1)
) WITH COMPACT STORAGE AND
  bloom_filter_fp_chance=0.100000 AND
  caching='ALL' AND
  comment='' AND
  dclocal_read_repair_chance=0.050000 AND
  gc_grace_seconds=864000 AND
  index_interval=128 AND
  read_repair_chance=0.000000 AND
  replicate_on_write='true' AND
  populate_io_cache_on_flush='false' AND
  default_time_to_live=0 AND
  speculative_retry='NONE' AND
  memtable_flush_period_in_ms=0 AND
  compaction={'class': 'LeveledCompactionStrategy'};

CREATE TABLE "CNSSubscriptionAttributes" (
  "subscriptionArn" text,
  "confirmationWasAuthenticated" boolean,
  "deliveryPolicy" text,
  "effectiveDeliveryPolicy" text,
  "topicArn" text,
  "userId" text,
  PRIMARY KEY (("subscriptionArn"))
) WITH COMPACT STORAGE AND
  bloom_filter_fp_chance=0.100000 AND
  caching='ALL' AND
  comment='' AND
  dclocal_read_repair_chance=0.050000 AND
  gc_grace_seconds=864000 AND
  index_interval=128 AND
  read_repair_chance=0.000000 AND
  replicate_on_write='true' AND
  populate_io_cache_on_flush='false' AND
  default_time_to_live=0 AND
  speculative_retry='NONE' AND
  memtable_flush_period_in_ms=0 AND
  compaction={'class': 'LeveledCompactionStrategy'} AND
  compression={'sstable_compression': 'LZ4Compressor'};

CREATE TABLE "CNSTopicAttributes" (
  "topicArn" text,
  "effectiveDeliveryPolicy" text,
  "policy" text,
  "userId" text,
  PRIMARY KEY (("topicArn"))
) WITH COMPACT STORAGE AND
  bloom_filter_fp_chance=0.100000 AND
  caching='ALL' AND
  comment='' AND
  dclocal_read_repair_chance=0.050000 AND
  gc_grace_seconds=864000 AND
  index_interval=128 AND
  read_repair_chance=0.000000 AND
  replicate_on_write='true' AND
  populate_io_cache_on_flush='false' AND
  default_time_to_live=0 AND
  speculative_retry='NONE' AND
  memtable_flush_period_in_ms=0 AND
  compaction={'class': 'LeveledCompactionStrategy'} AND
  compression={'sstable_compression': 'LZ4Compressor'};

CREATE TABLE "CNSTopicStats" (
  "topicArn" text,
  "status" text,
  "value" counter,
  PRIMARY KEY (("topicArn"), "status")
) WITH COMPACT STORAGE AND
  bloom_filter_fp_chance=0.010000 AND
  caching='ALL' AND
  comment='' AND
  dclocal_read_repair_chance=0.050000 AND
  gc_grace_seconds=864000 AND
  index_interval=128 AND
  read_repair_chance=0.000000 AND
  replicate_on_write='true' AND
  populate_io_cache_on_flush='false' AND
  default_time_to_live=0 AND
  speculative_retry='NONE' AND
  memtable_flush_period_in_ms=0 AND
  compaction={'class': 'SizeTieredCompactionStrategy'} AND
  compression={'sstable_compression': 'LZ4Compressor'};

CREATE TABLE "CNSTopicSubscriptions" (
  "topicArn" text,
  "endpoint" text,
  "protocol" text,
  "subscriptionJson" text,
  PRIMARY KEY (("topicArn"), "endpoint", "protocol")
) WITH COMPACT STORAGE AND
  bloom_filter_fp_chance=0.100000 AND
  caching='KEYS_ONLY' AND
  comment='' AND
  dclocal_read_repair_chance=0.050000 AND
  gc_grace_seconds=864000 AND
  index_interval=128 AND
  read_repair_chance=0.000000 AND
  replicate_on_write='true' AND
  populate_io_cache_on_flush='false' AND
  default_time_to_live=0 AND
  speculative_retry='NONE' AND
  memtable_flush_period_in_ms=0 AND
  compaction={'class': 'LeveledCompactionStrategy'} AND
  compression={'chunk_length_kb': '64', 'sstable_compression': 'SnappyCompressor'};

CREATE TABLE "CNSTopicSubscriptionsIndex" (
  "subscriptionArn" text,
  "endpoint" text,
  "protocol" text,
  PRIMARY KEY ((subscriptionArn), endpoint)
) WITH COMPACT STORAGE AND
  bloom_filter_fp_chance=0.100000 AND
  caching='ALL' AND
  comment='' AND
  dclocal_read_repair_chance=0.050000 AND
  gc_grace_seconds=864000 AND
  index_interval=128 AND
  read_repair_chance=0.000000 AND
  replicate_on_write='true' AND
  populate_io_cache_on_flush='false' AND
  default_time_to_live=0 AND
  speculative_retry='NONE' AND
  memtable_flush_period_in_ms=0 AND
  compaction={'class': 'LeveledCompactionStrategy'} AND
  compression={'sstable_compression': 'LZ4Compressor'};

CREATE TABLE "CNSTopicSubscriptionsTokenIndex" (
  "token" text,
  "subscriptionArn" text,
  "value" text,
  PRIMARY KEY (("token"), "subscriptionArn")
) WITH COMPACT STORAGE AND
  bloom_filter_fp_chance=0.100000 AND
  caching='ALL' AND
  comment='' AND
  dclocal_read_repair_chance=0.050000 AND
  gc_grace_seconds=864000 AND
  index_interval=128 AND
  read_repair_chance=0.000000 AND
  replicate_on_write='true' AND
  populate_io_cache_on_flush='false' AND
  default_time_to_live=0 AND
  speculative_retry='NONE' AND
  memtable_flush_period_in_ms=0 AND
  compaction={'class': 'LeveledCompactionStrategy'} AND
  compression={'sstable_compression': 'LZ4Compressor'};

CREATE TABLE "CNSTopicSubscriptionsUserIndex" (
  userId text,
  subscriptionArn text,
  value text,
  PRIMARY KEY (("userId"), "subscriptionArn")
) WITH COMPACT STORAGE AND
  bloom_filter_fp_chance=0.100000 AND
  caching='KEYS_ONLY' AND
  comment='' AND
  dclocal_read_repair_chance=0.050000 AND
  gc_grace_seconds=864000 AND
  index_interval=128 AND
  read_repair_chance=0.000000 AND
  replicate_on_write='true' AND
  populate_io_cache_on_flush='false' AND
  default_time_to_live=0 AND
  speculative_retry='NONE' AND
  memtable_flush_period_in_ms=0 AND
  compaction={'class': 'LeveledCompactionStrategy'} AND
  compression={'sstable_compression': 'LZ4Compressor'};

CREATE TABLE "CNSTopics" (
  "topicArn" text,
  "displayName" text,
  "name" text,
  "userId" text,
  PRIMARY KEY (("topicArn"))
) WITH COMPACT STORAGE AND
  bloom_filter_fp_chance=0.100000 AND
  caching='ALL' AND
  comment='' AND
  dclocal_read_repair_chance=0.050000 AND
  gc_grace_seconds=864000 AND
  index_interval=128 AND
  read_repair_chance=0.000000 AND
  replicate_on_write='true' AND
  populate_io_cache_on_flush='false' AND
  default_time_to_live=0 AND
  speculative_retry='NONE' AND
  memtable_flush_period_in_ms=0 AND
  compaction={'class': 'LeveledCompactionStrategy'} AND
  compression={'sstable_compression': 'LZ4Compressor'};

CREATE TABLE "CNSTopicsByUserId" (
  "userId" text,
  "topicArn" text,
  value text,
  PRIMARY KEY (("userId"), "topicArn")
) WITH COMPACT STORAGE AND
  bloom_filter_fp_chance=0.100000 AND
  caching='ALL' AND
  comment='' AND
  dclocal_read_repair_chance=0.050000 AND
  gc_grace_seconds=864000 AND
  index_interval=128 AND
  read_repair_chance=0.000000 AND
  replicate_on_write='true' AND
  populate_io_cache_on_flush='false' AND
  default_time_to_live=0 AND
  speculative_retry='NONE' AND
  memtable_flush_period_in_ms=0 AND
  compaction={'class': 'LeveledCompactionStrategy'} AND
  compression={'sstable_compression': 'LZ4Compressor'};

CREATE TABLE "CNSWorkers" (
  host text,
  producerTimestamp text,
  consumerTimestamp text,
  jmxport text,
  mode text,
  PRIMARY KEY ((host))
) WITH COMPACT STORAGE AND
  bloom_filter_fp_chance=0.100000 AND
  caching='ALL' AND
  comment='' AND
  dclocal_read_repair_chance=0.050000 AND
  gc_grace_seconds=864000 AND
  index_interval=128 AND
  read_repair_chance=0.000000 AND
  replicate_on_write='true' AND
  populate_io_cache_on_flush='false' AND
  default_time_to_live=0 AND
  speculative_retry='NONE' AND
  memtable_flush_period_in_ms=0 AND
  compaction={'class': 'LeveledCompactionStrategy'} AND
  compression={'sstable_compression': 'LZ4Compressor'};

USE "CQS";

CREATE TABLE "CQSAPIServers" (
  "host" text,
  "timestamp" text,
  "port" text,
  "jmxport" text,
  "dataCenter" text,
  "serviceUrl" text,
  "redisServerList" text,
  PRIMARY KEY ((host))
) WITH COMPACT STORAGE AND
  bloom_filter_fp_chance=0.100000 AND
  caching='ALL' AND
  comment='' AND
  dclocal_read_repair_chance=0.050000 AND
  gc_grace_seconds=864000 AND
  index_interval=128 AND
  read_repair_chance=0.000000 AND
  replicate_on_write='true' AND
  populate_io_cache_on_flush='false' AND
  default_time_to_live=0 AND
  speculative_retry='NONE' AND
  memtable_flush_period_in_ms=0 AND
  compaction={'class': 'LeveledCompactionStrategy'} AND
  compression={'sstable_compression': 'LZ4Compressor'};

CREATE TABLE "CQSPartitionedQueueMessages" (
  "queueShardPartition" text,
  "becomeVisibleTime" bigint,
  "nodeUUID" bigint,
  "message" text,
  PRIMARY KEY ((queueShardPartition), becomeVisibleTime, nodeUUID)
) WITH COMPACT STORAGE AND
  bloom_filter_fp_chance=0.100000 AND
  caching='KEYS_ONLY' AND
  comment='' AND
  dclocal_read_repair_chance=0.050000 AND
  gc_grace_seconds=5 AND
  index_interval=128 AND
  read_repair_chance=0.000000 AND
  replicate_on_write='true' AND
  populate_io_cache_on_flush='false' AND
  default_time_to_live=0 AND
  speculative_retry='NONE' AND
  memtable_flush_period_in_ms=0 AND
  compaction={'class': 'LeveledCompactionStrategy'} AND
  compression={'chunk_length_kb': '64', 'sstable_compression': 'SnappyCompressor'};

CREATE TABLE "CQSQueues" (
  "relativeUrl" text,
  "queueArn" text,
  "name" text,
  "userId" text,
  "region" text,
  "serviceEndpoint" text,
  "visibilityTO" text,
  "maxMsgSize" text,
  "msgRetentionPeriod" text,
  "delaySeconds" text,
  "policy" text,
  "createdTime" text,
  "waitTime" text,
  "numberOfPartitions" text,
  "numberOfShards" text,
  "compressed" text,
  "redrivePolicy" text,
  PRIMARY KEY (("relativeUrl"))
) WITH COMPACT STORAGE AND
  bloom_filter_fp_chance=0.100000 AND
  caching='ALL' AND
  comment='' AND
  dclocal_read_repair_chance=0.050000 AND
  gc_grace_seconds=864000 AND
  index_interval=128 AND
  read_repair_chance=0.000000 AND
  replicate_on_write='true' AND
  populate_io_cache_on_flush='false' AND
  default_time_to_live=0 AND
  speculative_retry='NONE' AND
  memtable_flush_period_in_ms=0 AND
  compaction={'class': 'LeveledCompactionStrategy'} AND
  compression={'sstable_compression': 'LZ4Compressor'};

CREATE TABLE "CQSQueuesByUserId" (
  "userId" text,
  "queueArn" text,
  "createdTime" text,
  value text,
  PRIMARY KEY (("userId"), "queueArn")
) WITH COMPACT STORAGE AND
  bloom_filter_fp_chance=0.100000 AND
  caching='KEYS_ONLY' AND
  comment='' AND
  dclocal_read_repair_chance=0.050000 AND
  gc_grace_seconds=864000 AND
  index_interval=128 AND
  read_repair_chance=0.000000 AND
  replicate_on_write='true' AND
  populate_io_cache_on_flush='false' AND
  default_time_to_live=0 AND
  speculative_retry='NONE' AND
  memtable_flush_period_in_ms=0 AND
  compaction={'class': 'LeveledCompactionStrategy'} AND
  compression={'sstable_compression': 'LZ4Compressor'};

USE "CMB";

CREATE TABLE "Users" (
  "userId" text,
  "userName" text,
  "accessKey" text,
  "accessSecret" text,
  "description" text,
  "hashPassword" text,
  "isAdmin" text,
  PRIMARY KEY ((userId))
) WITH COMPACT STORAGE AND
  bloom_filter_fp_chance=0.100000 AND
  caching='ALL' AND
  comment='' AND
  dclocal_read_repair_chance=0.050000 AND
  gc_grace_seconds=864000 AND
  index_interval=128 AND
  read_repair_chance=0.000000 AND
  replicate_on_write='true' AND
  populate_io_cache_on_flush='false' AND
  default_time_to_live=0 AND
  speculative_retry='NONE' AND
  memtable_flush_period_in_ms=0 AND
  compaction={'class': 'LeveledCompactionStrategy'} AND
  compression={'sstable_compression': 'LZ4Compressor'};

CREATE TABLE "UserIdByName" (
  "userId" text,
  "userName" text,
  "hashPassword" text,
  PRIMARY KEY ((userName))
) WITH COMPACT STORAGE AND
  bloom_filter_fp_chance=0.100000 AND
  caching='ALL' AND
  comment='' AND
  dclocal_read_repair_chance=0.050000 AND
  gc_grace_seconds=864000 AND
  index_interval=128 AND
  read_repair_chance=0.000000 AND
  replicate_on_write='true' AND
  populate_io_cache_on_flush='false' AND
  default_time_to_live=0 AND
  speculative_retry='NONE' AND
  memtable_flush_period_in_ms=0 AND
  compaction={'class': 'LeveledCompactionStrategy'} AND
  compression={'sstable_compression': 'LZ4Compressor'};

CREATE TABLE "userIdsByAccessKey" (
  "userId" text,
  "accessKey" text,
  "accessSecret" text,
  PRIMARY KEY ((accessKey))
) WITH COMPACT STORAGE AND
  bloom_filter_fp_chance=0.100000 AND
  caching='ALL' AND
  comment='' AND
  dclocal_read_repair_chance=0.050000 AND
  gc_grace_seconds=864000 AND
  index_interval=128 AND
  read_repair_chance=0.000000 AND
  replicate_on_write='true' AND
  populate_io_cache_on_flush='false' AND
  default_time_to_live=0 AND
  speculative_retry='NONE' AND
  memtable_flush_period_in_ms=0 AND
  compaction={'class': 'LeveledCompactionStrategy'} AND
  compression={'sstable_compression': 'LZ4Compressor'};